# Autoencoder Configuration
# Compressed gene expression to latent space

model:
  n_genes: 0  # 0 = Auto-detect from dataset
  latent_dim: 256
  hidden_dim: [1024, 512]
  dropout_rate: 0.05

training:
  batch_size: 2048
  learning_rate: 1e-4
  weight_decay: 1e-5
  max_epochs: 50
  reconstruction_loss: mse  # mse / poisson / smooth_l1
  
  scheduler:
    mode: min
    factor: 0.5
    patience: 5

data:
  dataset_type: parquet
  
  # Paths to processed data (Zarr or Parquet shards)
  processed_path:
    train: data/ae_processed/train_shards
    val: data/ae_processed/val_shards
    test: data/ae_processed/test_shards
    ood: data/ae_processed/ood_shards
    
  num_workers: 8 # Reduced to avoid CPU contention / soft lockups
  pin_memory: true

logging:
  output_dir: output/ae
  log_every_n_steps: 50
  val_check_interval: 2000 # Check validation every 2000 batches (approx 10% of epoch if ~20k batches)
  log_embeddings_every_n_epochs: 10

accelerator:
  accelerator: auto
  devices: auto
  precision: 16-mixed
  gradient_clip_val: 1.0
