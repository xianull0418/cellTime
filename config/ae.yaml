# Autoencoder Configuration
# Compressed gene expression to latent space

model:
  n_genes: 0  # 0 = Auto-detect from dataset
  latent_dim: 512
  hidden_dim: [4096, 2048, 1024]
  dropout_rate: 0.1

training:
  batch_size: 4096
  learning_rate: 1e-3
  weight_decay: 1e-5
  max_epochs: 50
  reconstruction_loss: smooth_l1  # mse / poisson / smooth_l1

  scheduler:
    mode: min
    factor: 0.5
    patience: 10

data:
  # Dataset type: parquet, zarr, or tiledb
  # - parquet: Streaming from sharded parquet files (good for large datasets)
  # - tiledb: True lazy loading with sparse arrays (best for very large datasets >10M cells)
  dataset_type: parquet

  # Paths to processed data
  # For parquet: point to *_shards directories
  # For tiledb: point to *_tiledb directories
  processed_path:
    train: data/ae_processed/train_shards
    val: data/ae_processed/val_shards
    test: data/ae_processed/test_shards
    ood: data/ae_processed/ood_shards

  # DataLoader settings
  num_workers: 4       # Workers for data loading (0 for TileDB recommended)
  pin_memory: true

logging:
  output_dir: output/ae
  log_every_n_steps: 50
  val_check_interval: 1.0
  log_embeddings_every_n_epochs: 5

accelerator:
  accelerator: auto
  devices: auto
  precision: 16-mixed
  gradient_clip_val: 1.0
