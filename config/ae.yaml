# Autoencoder 配置文件
# 用于训练单细胞数据的自编码器，将原始基因表达压缩到潜空间

model:
  n_genes: 3000  # 基因数量，从数据自动推断
  latent_dim: 256  # 潜空间维度
  hidden_dim: [1024, 512]  # 隐藏层维度
  dropout_rate: 0.1  # Dropout 比率

training:
  batch_size: 256  # 批次大小
  learning_rate: 1e-3  # 学习率
  weight_decay: 1e-5  # 权重衰减
  max_epochs: 100  # 最大训练轮数
  reconstruction_loss: mse  # 重建损失函数：mse/poisson/smooth_l1
  
  # 学习率调度器
  scheduler:
    mode: min  # 监控模式
    factor: 0.5  # 衰减因子
    patience: 10  # 等待轮数

data:
  dataset_type: parquet  # parquet / h5ad
  data_path: null  # Legacy support
  
  # scBank paths (generated by dataset/ae_data_process.py)
  scbank_path:
    train: data/processed/train.scbank
    ood: data/processed/ood.scbank
    
  # Processing config
  process:
    min_genes: 200
    train_ratio: 0.95  # Train/Val split ratio for training set
    
  vocab_path: null # 基因词汇表路径（可选），如果提供则强制使用此词表
  num_workers: 4  # 数据加载线程数
  pin_memory: true  # 是否固定内存

logging:
  output_dir: output/ae  # 输出目录
  log_every_n_steps: 50  # 日志记录频率
  val_check_interval: 0.5  # 验证频率（每半个 epoch）
  log_embeddings_every_n_epochs: 10  # 记录嵌入频率

accelerator:
  accelerator: auto  # 加速器类型：auto/gpu/cpu
  devices: auto  # 设备数量
  precision: 32  # 精度：32/16
  gradient_clip_val: 1.0  # 梯度裁剪值
